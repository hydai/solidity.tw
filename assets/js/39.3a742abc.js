(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{361:function(n,e,t){"use strict";t.r(e);var a=t(17),r=Object(a.a)({},(function(){var n=this,e=n._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"erc721-的列舉擴充-enumeration-extension"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#erc721-的列舉擴充-enumeration-extension"}},[n._v("#")]),n._v(" ERC721 的列舉擴充（enumeration extension）")]),n._v(" "),e("p",[n._v("除了元資料擴充功能以外，為了能方便查詢發行量、能依序列出所有未被銷毀的 NFT、以及能列舉特定帳戶持有的 NFT，因此設計出這個介面。")]),n._v(" "),e("h2",{attrs:{id:"列舉擴充介面"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#列舉擴充介面"}},[n._v("#")]),n._v(" 列舉擴充介面")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("interface ERC721Enumerable /* is ERC721 */ {\n    /// 回傳目前發行的 ERC721 總量\n    function totalSupply() external view returns (uint256);\n\n    /// 回傳第 `_index` 個未被銷毀的 NFT tokenId\n    function tokenByIndex(uint256 _index) external view returns (uint256);\n\n    /// 回傳第 `_index` 個由 `_owner` 帳戶持有的 NFT tokenId\n    function tokenOfOwnerByIndex(address _owner, uint256 _index) external view returns (uint256);\n}\n")])])]),e("h2",{attrs:{id:"代價"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#代價"}},[n._v("#")]),n._v(" 代價")]),n._v(" "),e("p",[n._v("當然，凡事都有代價，尤其是要方便查詢的話，自然需要在區塊鏈上多儲存資訊。以 "),e("a",{attrs:{href:"https://github.com/OpenZeppelin/openzeppelin-contracts/blob/master/contracts/token/ERC721/extensions/ERC721Enumerable.sol",target:"_blank",rel:"noopener noreferrer"}},[n._v("OpenZeppelin 的 ERC721 Enumerable 合約為例"),e("OutboundLink")],1),n._v("，我們可以發現它新增了以下幾個狀態變數：")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("    // 映射擁有者到他所持有的 NFT 列表\n    // 擁有者位址 => Index => TokenId\n    mapping(address => mapping(uint256 => uint256)) private _ownedTokens;\n\n    // 映射 token ID 到擁有者的 NFT 列表中的 Index \n    // TokenId => Index of `_ownedTokens`\n    mapping(uint256 => uint256) private _ownedTokensIndex;\n\n    // 用來儲存所有 token ID，因此可以快速查詢總發行量，也能方便列舉\n    uint256[] private _allTokens;\n\n    // 映射 token ID 到所有 token ID 陣列的 Index\n    // token ID => Index of `_allTokens`\n    mapping(uint256 => uint256) private _allTokensIndex;\n")])])]),e("p",[n._v("由於提供此功能所付出的代價不低，因此也有其他的 ERC721 的變種，就讓我們後面再來聊聊吧。")])])}),[],!1,null,null,null);e.default=r.exports}}]);